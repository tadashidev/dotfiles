
monitor=,preferred,auto,1

$terminal = ghostty
$browser = sway-launcher-desktop run-desktop ~/.local/share/applications/chromium-browser.desktop
$menu = ghostty --class=local.runner --linux-cgroup=never --gtk-single-instance=false -e sway-launcher-desktop

env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24

env = TERMINAL,$terminal
env = PROTON_ENABLE_WAYLAND,1

exec-once = hyprsunset
exec-once = hyprpaper
exec-once = hypridle
exec-once = wl-clip-persist --clipboard regular
exec-once = clipse -listen
exec-once = fcitx5 --replace -d
exec-once = wayland-pipewire-idle-inhibit

ecosystem {
  enforce_permissions = 1
}
permission = /nix/store/[a-z0-9]{32}-grim-[0-9.]*/bin/grim, screencopy, allow

permission = /nix/store/[a-z0-9]{32}-hyprland-.*/bin/hyprctl, plugin, allow

general {
    gaps_in = -2
    gaps_out = -4
    border_size = 4
    
    col.inactive_border = rgb(144,140,170)
    col.active_border = rgb(82,79,103)
    
    resize_on_border = true
    hover_icon_on_border = true
    
    snap {
        enabled = true
        window_gap = 32
        monitor_gap = 32
        border_overlap = true
        respect_gaps = true
    }
    
    layout = scrolling
}

exec-once = hyprctl plugin load ~/.local/bin/libhyprscrolling.so

plugin {
	hyprscrolling {
		fullscreen_on_one_column = true
		column_width = 0.7
		explicit_column_widths = 0.3, 0.7, 1
		focus_fit_method = 1
		follow_focus = true
	}
}

decoration {
    blur {
        enabled = false
    }
    
    shadow {
        enabled = false
    }
    
    dim_around = 0.2
}

animations {
    enabled = false
}

# No gaps/borders when only.
workspace = w[tv1], gapsout:0, gapsin:0
workspace = f[1], gapsout:0, gapsin:0
windowrule = match:float false, match:workspace w[tv1], border_size 0
windowrule = match:float false, match:workspace w[tv1], rounding 0
windowrule = match:float false, match:workspace f[1], border_size 0
windowrule = match:float false, match:workspace f[1], rounding 0

# Round border on floating windows.
windowrule = match:float true, rounding 4
windowrule = match:float true, rounding_power 4

misc {
    disable_autoreload = true
    
    disable_hyprland_logo = true
    force_default_wallpaper = 1
    
    key_press_enables_dpms = true
    
    col.splash = 0x575279FF
    splash_font_family = Go Smallcaps
    
    enable_swallow = true
    swallow_regex = com.mitchellh.ghostty
    
    on_focus_under_fullscreen = 1
    initial_workspace_tracking = 2
    
    enable_anr_dialog = true
    anr_missed_pings = 4
}

input {
    kb_layout = us
    
    follow_mouse = 2
    sensitivity = 0.1
    
    touchpad {
        disable_while_typing = false
        natural_scroll = true
    }
}

cursor {
    inactive_timeout = 8
    
    persistent_warps = true
    warp_on_change_workspace = 1
    warp_on_toggle_special = 1
    
    hide_on_key_press = true
}

binds {
    hide_special_on_workspace_change = true
    workspace_center_on = 1
}

xwayland {
    enabled = true
    force_zero_scaling = true
    create_abstract_socket = true
}

render {
    #new_render_scheduling = true
}

$mainMod = SUPER

bind = $mainMod, Return, exec, $terminal
bind = $mainMod, Q, killactive,
bind = $mainMod, Space, exec, $menu

bind = $mainMod, F, togglefloating

bind = $mainMod, Tab, togglespecialworkspace, systeminfo

exec-once = [workspace name:primary] $terminal
exec-once = [workspace name:primary] $browser
workspace = special:systeminfo, on-created-empty:$terminal -e btop

$outputScreenshot = ~/Pictures/Screenshots/"$(date +'Screenshot_%Y%m%d-%H%M%S.png')"
bind = , Print, exec, grim -t png -l 9 - | tee $outputScreenshot | wl-copy --type image/png
bind = Control, Print, exec, grim -g "$(slurp)" -t png -l 9 - | tee $outputScreenshot | wl-copy --type image/png
bind = Shift, Print, exec, grim -g "$(slurp)" -t ppm - | satty --filename - --fullscreen --disable-notifications --save-after-copy --early-exit --font-family 'Atkinson Hyperlegible Next' --initial-tool arrow --output-filename $outputScreenshot --copy-command 'wl-copy --type image/png'

$keyPseudoLeft = C
$keyPseudoUp = A
$keyPseudoRight = I
$keyPseudoDown = E

bind = $mainMod, $keyPseudoLeft, layoutmsg, move -col
bind = $mainMod, $keyPseudoRight, layoutmsg, move +col

bind = $mainMod, $keyPseudoUp, workspace, name:primary
bind = $mainMod, $keyPseudoDown, workspace, name:secondary

bind = $mainMod Shift, Space, layoutmsg, colresize +conf

bind = $mainMod Shift, $keyPseudoUp, movetoworkspace, name:primary
bind = $mainMod Shift, $keyPseudoDown, movetoworkspace, name:secondary

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

bindel = ,XF86AudioRaiseVolume, exec, wpctl set-volume -l 1 @DEFAULT_AUDIO_SINK@ 5%+
bindel = ,XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindel = ,XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindel = ,XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = ,XF86MonBrightnessUp, exec, brillo -u 150000 -q -A 2
bindel = ,XF86MonBrightnessDown, exec, brillo -u 150000 -q -U 2

bindl = , XF86AudioNext, exec, playerctl next
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPrev, exec, playerctl previous

windowrule {
    # Ignore maximize requests from all apps.
    name = suppress-maximize-events
    match:class = .*
    suppress_event = maximize
}

windowrule {
    # Fix some dragging issues with XWayland
    name = fix-xwayland-drags
    match:class = ^$
    match:title = ^$
    match:xwayland = true
    match:float = true
    match:fullscreen = false
    match:pin = false
    no_focus = true
}

# App launcher.
windowrule = match:class local.runner, float true
windowrule = match:class local.runner, size 50% 75%
windowrule = match:class local.runner, center true
windowrule = match:class local.runner, pin true
windowrule = match:class local.runner, stay_focused true
windowrule = match:class local.runner, dim_around true

